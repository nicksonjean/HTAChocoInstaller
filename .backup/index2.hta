<html lang="en" ng-app="Marijuana">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=9">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="SPA for Fetch, List, Install and Uninstall chocolatey Packages">
  <meta name="author" content="Nickson Jeanmerson & Stefferson Thallys">
  <meta property="og:title" content="Brownie Marijuana - v0.1">
  <meta property="og:type" content="SPA">
  <meta property="og:url" content="https://www.sitepoint.com/a-basic-html5-template/">
  <meta property="og:description" content="SPA for Fetch, List, Install and Uninstall chocolatey Packages">
  <meta property="og:image" content="./Assets/favicon.png">
  <link rel="icon" href="./Assets/favicon.ico">
  <link rel="icon" href="./Assets/favicon.svg" type="image/svg+xml">
  <title>Brownie Marijuana - v0.1</title>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.8/angular.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css" type="text/css">

  <script type="text/vbscript">
      Sub window_onload()
        'CenterWindow 520, 600
        TheaterMode()
        htaConsole.toggle()
      End Sub     
      Sub TheaterMode()
        window.resizeTo screen.availWidth,screen.availHeight
        window.moveTo 0, 0
      End Sub
      Sub CenterWindow( widthX, heightY )
        self.ResizeTo widthX, heightY 
        self.MoveTo (screen.availWidth - widthX)/2, (screen.availHeight - heightY)/2
      End Sub
  </script>

  <script type="text/vbscript" src="./Libs/Functions.vbs"></script>
  <script type="text/vbscript" src="./Libs/Extensions/Run.vbs"></script>
  <script type="text/vbscript" src="./Main.vbs"></script>

  <script type="text/vbscript">
    Sub Msg(byval key, byval value)
      MsgBox key & ":" & value, vbInformation, "VBScript!"
    End Sub
  </script>

  <script>
    var app = angular.module("Marijuana", []);

    app.factory("WebApi", function($http){
      var jsonData = {};
      jsonData.getFeedId = function(callback){
        $http.jsonp("http://zipcloud.ibsnet.co.jp/api/search?zipcode=1620825&callback=JSON_CALLBACK")
        .success(function(data){
          callback(data);
        })
        .error(function(data){
          alert("APIデータ取得失敗");
        })
      }
      return jsonData;
    });

    app.controller("controller", ["$scope", "WebApi", function($scope, WebApi){
      WebApi.getFeedId(function(data){
        $scope.items = data.results;
      });
    }]);

  </script>
</head>

<body ng-controller="controller">
  <script src="./Libs/HTAConsole.js"></script>

  <div class="container">
    <div class="jumbotron">
      <h1>HTA + AngularJS + JSONP</h1>
      <p>時々、VBScript</p>
    </div>

    <div id="maconha"></div>

    <div class="page-header">
      <h2><i class="fa fa-star fa-fw fa-spin"></i>JSOPで取得したデータ</h2>
    </div>
    <pre>{{ items }}</pre>

    <div class="page-header">
      <h2><i class="fa fa-star fa-fw fa-spin"></i>AngularJS で展開して VBScript のMsgBox表示</h2>
    </div>
    <ul ng-repeat="item in items" class="list-group">
      <li ng-repeat="(key, value) in item" class="list-group-item">

      <h3>
        <span class="label label-success">key</span> {{ key }}
        <span class="label label-danger">value</span> {{ value }}
      </h3>

      <form>
        <input type="hidden" name="textbox1" value="{{ key }}" />
        <input type="hidden" name="textbox2" value="{{ value }}" />
        <button type="button" class="btn btn-lg btn-info" onclick="vbscript:Msg(textbox1.value, textbox2.value)">click me!</button>
      </form>
      </li>
    </ul>
  </div>

  <div class="container-fluid p-0 m-0">
    <div class="container-xxl px-0">
      <div class="row m-2 align-items-center">
        <div class="col-lg-6 col-md-8 px-0 mx-auto">
          <form>
            <div class="row">
              <label for="packageSearch" class="m-0">Pacotes</label>
              <div class="input-group">
                <input
                  type="text"
                  class="form-control shadow-none"
                  id="packageSearch"
                  placeholder="Localize Pacotes"
                />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="button">
                    Buscar <i class="fa fa-search"></i>
                  </button>
                </div>
              </div>
              <small
                id="packageSearchHelpBlock"
                class="form-text text-muted m-0"
              >
                {{validation_message}}
              </small>
            </div>
          </form>
        </div>
      </div>

      <div class="row align-items-center mx-0 px-1">
        <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3 px-1 py-1">
          <div class="card">
            <div class="row no-gutters mx-0">
              <div
                class="
                  col-auto
                  text-right
                  p-2
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <img
                  height="50"
                  width="50"
                  src="https://tarkhov.github.io/postboot/assets/img/thumbnail.jpg"
                />
              </div>
              <div
                class="
                  col
                  text-left
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <div class="card-body pb-0 pl-0 pl-lg-0 pr-2 pt-2">
                  <h6 class="card-title fw-normal">
                    March 2014 servicing stack update for Windows 8.1 and
                    Windows Server 2012 R2 (KB2919442)
                  </h6>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white px-2">
              <div class="input-group">
                <input
                  type="text"
                  class="form-control shadow-none"
                  id="packageSearch"
                  readonly
                  value="> choco install maconha"
                />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="button">
                    <i class="fa fa-copy"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3 px-1 py-1">
          <div class="card">
            <div class="row no-gutters mx-0">
              <div
                class="
                  col-auto
                  text-right
                  p-2
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <img
                  height="50"
                  width="50"
                  src="https://tarkhov.github.io/postboot/assets/img/thumbnail.jpg"
                />
              </div>
              <div
                class="
                  col
                  text-left
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <div class="card-body pb-0 pl-0 pl-lg-0 pr-2 pt-2">
                  <h6 class="card-title fw-normal">
                    March 2014 servicing stack update for Windows 8.1 and
                    Windows Server 2012 R2 (KB2919442)
                  </h6>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white px-2">
              <div class="input-group">
                <input
                  type="text"
                  class="form-control shadow-none"
                  id="packageSearch"
                  readonly
                  value="> choco install maconha"
                />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="button">
                    <i class="fa fa-copy"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3 px-1 py-1">
          <div class="card">
            <div class="row no-gutters mx-0">
              <div
                class="
                  col-auto
                  text-right
                  p-2
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <img
                  height="50"
                  width="50"
                  src="https://tarkhov.github.io/postboot/assets/img/thumbnail.jpg"
                />
              </div>
              <div
                class="
                  col
                  text-left
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <div class="card-body pb-0 pl-0 pl-lg-0 pr-2 pt-2">
                  <h6 class="card-title fw-normal">
                    March 2014 servicing stack update for Windows 8.1 and
                    Windows Server 2012 R2 (KB2919442)
                  </h6>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white px-2">
              <div class="input-group">
                <input
                  type="text"
                  class="form-control shadow-none"
                  id="packageSearch"
                  readonly
                  value="> choco install maconha"
                />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="button">
                    <i class="fa fa-copy"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-3 px-1 py-1">
          <div class="card">
            <div class="row no-gutters mx-0">
              <div
                class="
                  col-auto
                  text-right
                  p-2
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <img
                  height="50"
                  width="50"
                  src="https://tarkhov.github.io/postboot/assets/img/thumbnail.jpg"
                />
              </div>
              <div
                class="
                  col
                  text-left
                  align-items-center
                  d-flex
                  justify-content-center
                "
              >
                <div class="card-body pb-0 pl-0 pl-lg-0 pr-2 pt-2">
                  <h6 class="card-title fw-normal">
                    March 2014 servicing stack update for Windows 8.1 and
                    Windows Server 2012 R2 (KB2919442)
                  </h6>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white px-2">
              <div class="input-group">
                <input
                  type="text"
                  class="form-control shadow-none"
                  id="packageSearch"
                  readonly
                  value="> choco install maconha"
                />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="button">
                    <i class="fa fa-copy"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    var InstalledPackage = JSON.parse(InstalledPackages)
    for(var k in InstalledPackage.packages) {
      console.log(
        InstalledPackage.packages[k].packageName + " - " + 
        InstalledPackage.packages[k].packageIcon + " - " + 
        InstalledPackage.packages[k].packageVersion
      );
    }
  </script>
  
  <!--[if gte IE 9]><!-->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
  <!--<![endif]-->
  <!--[if IE 9]>
    <script src="https://cdn.jsdelivr.net/gh/coliff/bootstrap-ie8/js/bootstrap-ie9.min.js"></script>
  <![endif]-->
  <!--[if lte IE 8]>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/coliff/bootstrap-ie8/js/bootstrap-ie8.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.js"></script>
  <![endif]-->
</body>
</html>

<HTA:APPLICATION 
    ID="Marijuana"
    APPLICATIONNAME="Brownie Marijuana - v0.1"
    ICON="./Assets/favicon.ico"
    BORDERSTYLE     = "normal"
    CAPTION         = "no"
    CONTEXTMENU     = "no"
    SYSMENU         = "no"
    NAVIGABLE       = "no"
    INNERBORDER     = "no"
    SCROLL          = "yes"
    SELECTION       = "yes"
    SINGLEINSTANCE  = "yes"
    MAXIMIZEBUTTON  = "no"
    MINIMIZEBUTTON  = "no"
    WINDOWSTATE     = "normal"
    SHOWINTASKBAR   = "yes"
>